# Отчет о подготовке тестовых данных для kbd-translator

## Задача
Выбрать 100 случайных **сложных** предложений из корпуса `data/translations/sents_292k.csv` для тестирования skill перевода.

## Критерии отбора
- **Длина:** Русский текст > 100 символов (сложные предложения)
- **Метод выборки:** Случайный (seed=42 для воспроизводимости)
- **Источник:** 292,457 пар переводов из корпуса

## Результаты отбора

### Статистика найденных предложений
- **Всего в корпусе:** 292,457 пар переводов
- **Сложных предложений (>100 символов):** 147
- **Отобрано для теста:** 100

### Статистика длины отобранных предложений
```
Количество: 100
Длина русского текста:
  Min: 101 символ
  Max: 121 символ
  Avg: 105.0 символов
  Median: 104 символа
```

## Файлы для тестирования

### 1. `test_sentences_100.csv`
Основной файл с тестовыми данными.

**Структура:**
```csv
line_num,kbd_original,rus_original,rus_length,kbd_translated,match_score
2001,"- БгъэзэщIа ролхэм...","- Я бы хотел, чтобы ты рассказал...",105,"",""
```

**Колонки:**
- `line_num` - номер строки в оригинальном корпусе
- `kbd_original` - оригинальный кабардинский текст (эталон)
- `rus_original` - русский текст для перевода
- `rus_length` - длина русского текста
- `kbd_translated` - (пусто) для заполнения результатами перевода
- `match_score` - (пусто) для оценки качества

### 2. `test_5_samples.txt`
5 примеров для быстрого ручного тестирования.

### 3. `test_modified_sentences.txt`
5 модифицированных (перефразированных) предложений для теста способности к адаптации.

## Как использовать для тестирования

### Вариант 1: Ручное тестирование через kbd-translator skill

1. Открыть `test_sentences_100.csv`
2. Взять русское предложение из колонки `rus_original`
3. Активировать kbd-translator skill
4. Перевести русский → кабардинский
5. Сравнить результат с `kbd_original` (эталон)
6. Оценить качество перевода

### Вариант 2: Batch-тестирование

Использовать файл для массового тестирования:

```python
import csv

# Прочитать тестовые предложения
with open('test_sentences_100.csv', 'r', encoding='utf-8') as f:
    tests = list(csv.DictReader(f))

# Для каждого предложения:
for test in tests:
    rus_text = test['rus_original']
    kbd_expected = test['kbd_original']

    # TODO: Перевести через kbd-translator skill
    # kbd_translated = translate(rus_text)

    # Сравнить с эталоном
    # similarity = compare(kbd_translated, kbd_expected)
```

### Вариант 3: Тест на модифицированных предложениях

Использовать `test_modified_sentences.txt` для проверки способности skill адаптировать переводы к перефразированным предложениям.

## Примеры тестовых предложений

### Пример 1 (Line 2001)
```
RUS: - Я бы хотел, чтобы ты рассказал о роли, которая тебе больше всего запомнилась из тех, что ты сыграл.
KBD (эталон): - БгъэзэщIа ролхэм ящыщу уигу нэхъ зыкIэрыпщIам и гугъу уэзгъэщIынут.
Длина: 105 символов
```

### Пример 2 (Line 4738)
```
RUS: - Привлекаете ли вы молодое поколение, от которого зависит будущее народа, к культурным мероприятиям?
KBD (эталон): - Лъэпкъым и пщэдейр зэлъыта щIэблэр щэнхабзэ Iуэхухэм къыфхуешалIэрэ?
Длина: 105 символов
```

### Пример 3 (Line 17471)
```
RUS: Плохо то дело, которое тебе кажется таковым, если сделал хорошо, то тот, кому ты писал, получит то, что хотел.
KBD (эталон): Iуэху къыпщыхъурщ Iейр, ФIыт пщIамэ, зыхуэптхар зыхуейр.
Длина: 119 символов
```

## Метрики для оценки

### 1. Точное совпадение (Exact Match)
- Similarity ≥ 0.95 считается точным совпадением
- Учитывает нормализацию (ӏ→I, пробелы, пунктуация)

### 2. Схожесть строк (String Similarity)
- Используйте SequenceMatcher или edit distance
- Диапазон: 0.0 (совсем не похоже) - 1.0 (идентично)

### 3. Метод перевода
- `exact_match` - найдено точное совпадение в корпусе
- `keyword_match` - найдено по ключевым словам
- `pattern_adaptation` - LLM адаптировал паттерн
- `dictionary_fallback` - использованы словари

### 4. Уровень уверенности (Confidence)
- High (≥0.8) - высокая уверенность
- Medium (0.5-0.8) - средняя уверенность
- Low (<0.5) - низкая уверенность

## Baseline результаты (для сравнения)

При тестировании с **исключением** тестовых предложений из корпуса:
- **Exact matches:** 43% (43/100)
- **High similarity (≥0.8):** 45% (45/100)
- **Mean similarity:** 0.631
- **Medium similarity (0.5-0.8):** 5% (5/100)
- **Low similarity (<0.5):** 50% (50/100)

Это baseline для простого keyword matching **без LLM**.

Ожидается что **kbd-translator skill с LLM** покажет лучшие результаты!

## Следующие шаги

1. ✅ Выбрано 100 сложных предложений
2. ⏳ Тестирование через kbd-translator skill
3. ⏳ Сбор метрик качества
4. ⏳ Анализ ошибок и улучшение

---

**Файлы готовы к тестированию:**
- `test_sentences_100.csv` - основной файл с 100 предложениями
- `test_5_samples.txt` - 5 примеров для быстрого теста
- `test_modified_sentences.txt` - модифицированные предложения
