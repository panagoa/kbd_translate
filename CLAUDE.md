# CLAUDE.md

Этот файл содержит руководство для Claude Code (claude.ai/code) при работе с кодом в этом репозитории.

## Обзор проекта

Это проект перевода на кабардинский язык (kbd) на ранней стадии разработки. Кабардинский - это северо-западный кавказский язык. Проект работает с кабардинскими текстовыми данными и предоставляет инструменты для перевода с русского на кабардинский.

## Команды разработки

```bash
# Запуск основного приложения
python main.py

# Запуск с uv (если используется uv для управления зависимостями)
uv run main.py
```

## Структура проекта

```
kbd_translate/
├── main.py                      # Точка входа приложения
├── pyproject.toml              # Конфигурация Python проекта (требуется Python >=3.11)
├── data/                       # Данные кабардинского языка
│   ├── 00_kbd_sentences.csv    # CSV с кабардинскими предложениями (~7.3 МБ)
│   ├── translations/           # Примеры переводов
│   │   └── sents_292k.csv      # 292k пар переводов kbd→rus (~45 МБ)
│   └── glossary/               # Кабардинские словари (БОЛЬШИЕ ФАЙЛЫ)
│       ├── Rus-Ady_UASP.csv    # Русско-кабардинский словарь (~3.5 МБ)
│       └── Ady-Ady_AP.csv      # Кабардинский толковый словарь (~16 МБ)
└── .claude/
    └── skills/                 # Claude Skills для специализированных задач
        ├── kbd-translator/     # Перевод с русского на кабардинский
        ├── kbd-glossary/       # Поиск в словарях
        ├── kbd-morphology/     # Морфологический анализ слов
        └── skill-creator/      # Создание новых skills
```

## Claude Skills

Проект использует специализированные Claude Skills для эффективных рабочих процессов:

### kbd-translator
- **Назначение:** Эксперт по переводу с русского на кабардинский
- **Активируется при:** Запросах перевода, упоминании "перевод", "translate", "Kabardian"
- **Возможности:**
  - Преобразование порядка слов в SOV
  - Правильная морфология и синтаксис
  - Пост-обработка (стандартизация символов, пунктуация)
  - Детальные лингвистические правила в `reference.md`
- **Файлы:** `SKILL.md`, `reference.md`

### kbd-glossary
- **Назначение:** Поиск слов в кабардинских словарях
- **Активируется при:** Поиске в словаре, "найди слово", "glossary", "что означает"
- **Возможности:**
  - Быстрый поиск на основе Grep (оптимизирован для больших файлов)
  - Русско-кабардинский словарь (Rus-Ady_UASP.csv)
  - Кабардинский толковый словарь (Ady-Ady_AP.csv)
  - **Критично:** Всегда использует Grep, никогда не загружает полные файлы (16 МБ)
- **Файлы:** `SKILL.md`

### kbd-morphology
- **Назначение:** Морфологический анализ кабардинских слов
- **Активируется при:** "морфология", "разбор слова", "структура глагола", "префикс", "суффикс"
- **Возможности:**
  - Разбор глагольной структуры: `[PRAGM]-[GEOM]-[ARGS]-[STEM]-[TAM]-[SUBORD]`
  - Анализ multi-person verbs (до 4 участников)
  - Идентификация префиксов и суффиксов
  - Деривационные паттерны (causative, potential, reciprocal, reflexive)
  - Именная морфология (падежи, число, посессивность)
  - Детальные таблицы морфем в `reference_morphology.md`
- **Файлы:** `SKILL.md`, `reference_morphology.md`

### skill-creator
- **Назначение:** Создание новых Claude Skills согласно best practices Anthropic
- **Активируется при:** "create skill", "new skill", "создать skill"
- **Возможности:**
  - Интерактивный workflow
  - Архитектура progressive disclosure
  - Шаблоны и примеры
  - Соображения безопасности
- **Файлы:** `SKILL.md`, `template.md`, `best_practices.md`, `checklist.md`, `examples.md`

## Формат данных

### CSV с предложениями (00_kbd_sentences.csv)

- Единственная колонка "sent" с кабардинскими предложениями
- Использует кириллицу со специальными символами
- ~7.3 МБ, 100,000+ предложений

### Примеры переводов (translations/sents_292k.csv)

**⚠️ ВАЖНО: Это БОЛЬШОЙ файл (45 МБ, ~292,000 пар)**

**Формат:**
```csv
source,translated
"кабардинский текст","русский перевод"
```

**Содержимое:**
- Колонка 1 (source): Кабардинский текст (оригинал)
- Колонка 2 (translated): Русский перевод
- ~45 МБ, ~292,000 пар переводов
- Проверенные переводы из zbze_blog проекта

**Использование для поиска примеров:**
```bash
# Поиск примеров с русским словом (ограничить результаты!)
grep -i "слово" data/translations/sents_292k.csv | head -10

# Поиск примеров с кабардинским словом
grep -i "унэ" data/translations/sents_292k.csv | head -10
```

**⚠️ При работе с этим файлом:**
- ✅ Всегда используйте Grep с ограничением (`head -N` или `-m N`)
- ✅ Файл отлично подходит для поиска примеров переводов
- ❌ Никогда не загружайте весь файл с Read
- См. `kbd-translator` skill для деталей использования

### CSV файлы словарей (glossary/)

**⚠️ ВАЖНО: Это БОЛЬШИЕ файлы (3.5 МБ и 16 МБ)**

**Формат:**
```csv
"ключевое_слово","<div style=\"...\">HTML контент с определением</div>"
```

**Rus-Ady_UASP.csv (Русско-кабардинский):**
- Колонка 1: Русское слово (ключ)
- Колонка 2: HTML с кабардинским переводом и примерами
- ~3.5 МБ, ~50,000+ записей

**Ady-Ady_AP.csv (Кабардинский толковый):**
- Колонка 1: Кабардинское слово (ключ, часто в ВЕРХНЕМ регистре)
- Колонка 2: HTML с определением на кабардинском
- ~16 МБ, ~200,000+ записей

**При работе со словарями:**
- ✅ Всегда используйте Grep для поиска (быстро, потоково)
- ✅ Используйте `-m N` для ограничения результатов
- ❌ Никогда не используйте Read для загрузки всего файла
- См. skill `kbd-glossary` для деталей

## Особенности языка

### Кабардинский алфавит

Кабардинский использует расширенный кириллический алфавит:
- **Глоттальный смычка:** Ӏ (U+04CF, заглавная I с вертикальной чертой)
  - Стандартизирован в проекте как: **I** (латинская I)
- **Специальные диграфы:** щ, хь, къ, жь, гъ, кӏ, пӏ, тӏ, и т.д.
- **Кодировка:** Всегда используйте UTF-8

### Стандартизация символов

При обработке кабардинского текста применяйте эти преобразования:
```python
text = text.replace('ӏ', 'I')  # U+04CF → латинская I
text = text.replace('1', 'I')  # Цифра 1 → латинская I
text = text.replace('l', 'I')  # Строчная L → латинская I
```

### Порядок слов

- **Русский:** SVO (Подлежащее-Сказуемое-Дополнение)
- **Кабардинский:** SOV (Подлежащее-Дополнение-Сказуемое)
- Пример: "Я вижу дом" → "Сэ унэр сыплъ" (Я дом вижу)

См. `kbd-translator/reference.md` для полных лингвистических правил.

## Процесс перевода

Основан на `/Users/panagoa/PycharmProjects/zbze_blog/notebooks/antropic_translate_sents.ipynb`:

1. **Лингвистические требования:**
   - Порядок слов: паттерн SOV
   - Морфология: Правильные префиксы и суффиксы
   - Синтаксис: Правильная структура предложения
   - Семантика: Культурно-адекватные эквиваленты

2. **Формат вывода:**
   - Только переводы (без объяснений)
   - Каждый перевод на новой строке
   - Используйте "" для непереводимых предложений
   - Никогда не объединяйте предложения

3. **Пост-обработка:**
   - Стандартизация символов (ӏ→I, 1→I, l→I)
   - Добавление пунктуации если отсутствует (., ?, !)

## Примечания по производительности

### Работа с большими файлами

Словари очень большие (16 МБ). При поиске:

```bash
# ✅ ХОРОШО: Быстрый поиск на основе grep
grep -F -i -m 1 "\"слово\"" data/glossary/Rus-Ady_UASP.csv

# ❌ ПЛОХО: Загрузка всего файла в память
# Никогда не делайте: Чтение всего файла с помощью Read tool
```

Сравнение производительности:
- Grep (точное совпадение): <0.1 секунды
- Grep (частичное, ограниченное): 0.5-2 секунды
- Read всего файла: 5-10 секунд + высокое использование памяти

## Грамматические справочники

### Локальные академические материалы (`references/grammar/`)

Проект содержит выдержки из академической грамматики кабардинского языка для справки:

**Источник:** "Кабардино-Черкесский язык" (скопировано из deprecated проекта zbze_blog)

**Структура:**
- `verb_morphology/` - Chunks 23-30 (страницы 111-150, ~244KB)
  - Полисинтетизм глагола (polysynthesis)
  - Категория лица и полиперсонализм (multi-person verbs)
  - Глагольные парадигмы (1-4 participant verbs)
  - Детальные таблицы с примерами
- `phonetics/` - Chunks 6-9 (страницы 26-45, ~136KB)
  - Система фонем
  - Согласные и гласные
  - Морфофонологические процессы
- `nouns/` - Chunks 12-16 (страницы 61-83, ~180KB)
  - Категория определённости/неопределённости (-р маркер)
  - Система падежей (эргатив, послеложный, обстоятельственный)
  - Категория числа (-хэ, -хэр множественное число)
  - Категория притяжательности
  - Словообразование существительных
- `verbal_derivations/` - Chunks 44-49 (страницы 222-247, ~220KB)
  - Причастия (субъектные, объектные, обстоятельственные)
  - Деепричастия с суффиксами -у/-уэ и -рэ
  - Инфинитив и масдар
- `syntax/` - Chunks 56-80 (страницы 282-404, ~932KB) ⭐ **КРИТИЧНО**
  - Простое предложение (структура, типы)
  - Сказуемое и подлежащее
  - Дополнения и определения
  - **Словопорядок в простом предложении (SOV правила)** ⭐⭐⭐
  - Сложные предложения и подчинение
- `table_of_content.txt` - Полное оглавление (555+ записей)
- `table_of_content_to_index.txt` - Сопоставление страниц с файлами

**⭐ Особо важный раздел:** `syntax/` содержит фундаментальные правила порядка слов SOV, которые являются основой kbd-translator skill.

**Использование:**
- Дополняют упрощённые справочники в skills (`.claude/skills/*/reference_*.md`)
- Для сложных случаев и неоднозначностей
- Детальные примеры глагольных форм с множественными участниками
- См. `references/grammar/README.md` для подробностей

## Связанные проекты

- **zbze_blog** (`/Users/panagoa/PycharmProjects/zbze_blog/`) - **DEPRECATED**:
  - Содержит notebook с переводами: `notebooks/antropic_translate_sents.ipynb`
  - Источник промптов и процессов перевода
  - Грамматические справочники скопированы в `references/grammar/` этого проекта
